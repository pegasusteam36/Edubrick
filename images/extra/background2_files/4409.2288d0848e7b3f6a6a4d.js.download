"use strict";(this.webpackChunk_hz_project_x=this.webpackChunk_hz_project_x||[]).push([[4409],{745392:(r,e,t)=>{t.d(e,{El:()=>g,LU:()=>O,X5:()=>p});var o=t(55417),s=t(499164),a=t(847419),n=t(499631),i=t(289817),c=t(696463),u=t(263789),E=t(45276),d=t(565865);const p=3,l=["authorization",/.*token.*/],{problemTypesToErrorCode:f}=d,g=[a.o.TOO_MANY_REQUESTS,a.o.LOCKED,a.o.INTERNAL_SERVER_ERROR,a.o.BAD_GATEWAY,a.o.SERVICE_UNAVAILABLE,a.o.GATEWAY_TIMEOUT,a.o.INSUFFICIENT_STORAGE,a.o.NETWORK_FAILURE];class O{static isErrorStatus(r){return r<a.o.OK||r>=a.o.MULTIPLE_CHOICES}static isHttpError(r){return void 0!==r.headers}static isAutomaticRetryErrorStatus(r,e){return r instanceof n.o&&e.includes(r.httpStatus)}static isAutomaticRetryErrorStatusDCX(r,e){return!!r.response&&e.includes(r.response.statusCode)}static getAdobeDCXError(r){let e;return(0,E.isAdobeDCXError)(r)&&(e=r),r instanceof i.R&&(0,E.isAdobeDCXError)(r.previousError)&&(e=r.previousError),e}static getHttpErrorOptions(r){const e=O.getHzErrorOptions(r),t=r.response?.response;Object.assign(e.logMetadata,{responseBody:t});const o={requestId:r.response?.headers?.["x-request-id"],retryAfter:r.response?.headers?.["retry-after"]};return Object.assign(e,o),e}static getHzErrorOptions(r){return{previousError:r,category:"DCX",logMetadata:{sourceOfError:"DCX Library",package:"clouddocs"}}}static errorCodeFromStatusCode(r){if(0===r)return"NetworkError";let e=c.hX.get(r);return e||(e=r>400&&r<=499?"ClientError":r>500&&r<=599?"ServerError":"Http"),e}static errorCodeFromDCXError(r){return f.get(r.response?.response?.type)??O.errorCodeFromStatusCode(r.response?.statusCode)}static errorFromDCXError(r){if(r instanceof i.R)return r;if((0,E.isAdobeDCXError)(r)&&r.code){let e;const t=O.errorCodeFromDCXError(r);switch(r.code){case"ALREADY_EXISTS":case"FILE_EXISTS_IN_CLOUD":case"UPDATE_CONFLICT":e=new n.o(a.o.CONFLICT,r.message,t,O.getHttpErrorOptions(r));break;case"ASSET_NOT_FOUND":case"COMPOSITE_NOT_FOUND":case"DELETED_COMPOSITE":case"NOT_FOUND":case"NO_COMPOSITE":e=new n.o(a.o.NOT_FOUND,r.message,t,O.getHttpErrorOptions(r));break;case"EXCEEDS_QUOTA":case"FORBIDDEN":case"OUT_OF_SPACE":case"READ_ONLY":e=new n.o(a.o.FORBIDDEN,r.message,t,O.getHttpErrorOptions(r));break;case"NETWORK_ERROR":case"RETRYABLE_SERVER_ERROR":e=new n.o(a.o.GATEWAY_TIMEOUT,r.message,t,O.getHttpErrorOptions(r));break;case"SERVICE_IS_INACTIVE":e=new n.o(a.o.SERVICE_UNAVAILABLE,r.message,t,O.getHttpErrorOptions(r));break;case"TIMED_OUT":e=new n.o(a.o.REQUEST_TIMEOUT,r.message,t,O.getHttpErrorOptions(r));break;case"UNAUTHORIZED":e=new n.o(a.o.UNAUTHORIZED,r.message,t,O.getHttpErrorOptions(r));break;case"PRECONDITION_FAILED":e=new n.o(a.o.PRECONDITION_FAILED,r.message,t,O.getHttpErrorOptions(r));break;case"UNEXPECTED_RESPONSE":{const o=r.underlyingError;if((0,E.isAdobeDCXError)(o))return O.errorFromDCXError(o);if(r.response)if(r.response.statusCode===a.o.UNAUTHORIZED)e=new n.o(a.o.UNAUTHORIZED,r.message,t,O.getHttpErrorOptions(r));else{const t=r.response?.response?.error?.status??r.response.statusCode;e=new n.o(t,r.message,O.errorCodeFromStatusCode(t),O.getHttpErrorOptions(r))}else e=new i.R("UnhandledDCXError",r.message,O.getHzErrorOptions(r));break}default:{const t=r.underlyingError;if((0,E.isAdobeDCXError)(t))return O.errorFromDCXError(t);if(r.response){const t=r.response.statusCode;e=new n.o(t,r.message,O.errorCodeFromStatusCode(t),O.getHttpErrorOptions(r))}else e=new i.R("UnhandledDCXError",r.message,O.getHzErrorOptions(r))}}return e}return new i.R("UnhandledDCXError",r.message,O.getHzErrorOptions(r))}static isUserRetryErrorStatus(r){return g.indexOf(r)>-1}static isUserRetryHttpError(r){if(r){if(r instanceof n.o)return O.isUserRetryErrorStatus(r.httpStatus);if(r instanceof i.R&&r.previousError)return O.isUserRetryHttpError(r.previousError)}return!1}static isFetchFailedError(r){if(r){const e=void 0!==r.stack&&Boolean(r.stack.match(/^TypeError/))&&"Failed to fetch"===r.message,t=Boolean(r.message.match(/^NetworkError when attempting to fetch/))||"AbortError"===r.name,o=Boolean(r.message.match(/^Load failed/));if(e||t||o)return!0;if(r instanceof i.R&&r.previousError)return O.isFetchFailedError(r.previousError)}return!1}static async getResponseBody(r){let e;try{e=await r.json()}catch{}return e}static makeStandardHeaders(r,e,t=null){const s={"x-api-key":e,"Accept-Encoding":"br;q=1.0, gzip;q=0.9, *;q=0.5","x-request-id":(0,o.Z)()};return r&&Object.assign(s,{Authorization:"Bearer "+r}),t&&Object.assign(s,{"x-product":t}),s}static parseLinkHeader(r){if(0===r.length)return;const e={};return(0,s.parse)(r).refs.reduce(((r,t)=>(e[t.rel]={rel:t.rel,url:t.uri},t.templated&&(e[t.rel].templated="true"===t.templated.toLowerCase()),e)),e),e}static defaultDelayHook(r){if(r instanceof n.o&&r.headers.retryAfter)try{const e=r.headers.retryAfter;if(e){const r=1e3*Number.parseFloat(e);if(!isNaN(r))return{type:u.Zx.MINIMUM,value:r}}}catch(r){}}static defaultShouldRetryHook(r){return O.isAutomaticRetryErrorStatus(r,g)}static getDefaultRetryOptions(){return{shouldRetry:O.defaultShouldRetryHook,affectDelayHook:O.defaultDelayHook,maxAttempts:p}}static getLogInfoFromFetchResponse(r,e){const{status:t,ok:o,headers:s,url:a}=r;return{status:t,ok:o,headers:s,url:a,responseBody:e}}static standardRetryableClause(r){return O.isAutomaticRetryErrorStatusDCX(r,g)}static getRetryAfterInMsFromDCXError(r){try{if(r?.response?.headers){const e=O.getHeaderValueCaseInsensitive(r.response.headers,"retry-after");if(e){if(!isNaN(e))return 1e3*Number(e);{const r=Date.parse(e)-Date.now();if(r>0)return r}}}}catch(r){}}static getRedactedUrl(r){let e;try{e=new URL(r);const t=e.searchParams,o=new Set;l.forEach((r=>{if(r instanceof RegExp)for(const e of t.keys())r.test(e)&&o.add(e);else t.has(r)&&o.add(r)})),o.forEach((r=>t.set(r,"XXXXX")))}catch(e){return r}return e.toString()}static isHttpUrl(r){let e;try{e=new URL(r)}catch(r){return!1}return"http:"===e.protocol||"https:"===e.protocol}static formatStatusCode(r){return r.charAt(0)+"xx"}static getHeaderValueCaseInsensitive(r,e){if(r[e])return r[e];const t=e.toLowerCase();for(const e in r)if(e.toLowerCase()===t)return r[e]}}},104409:(r,e,t)=>{t.d(e,{V:()=>i,q:()=>p});var o=t(499631),s=t(289817),a=t(263789),n=t(745392);class i extends Error{constructor(r){super(),this.response=r}}const c="Fetch request aborted due to timeout",u="Fetch request aborted due to client cancelation";async function E(r,e,t,o,s,a){if(a?.aborted){const r=new Error(u);throw r.name="AbortError",r}let E,d;const p=e.abortController(),l=()=>{p.abort(u)};void 0!==a&&a.addEventListener("abort",l);try{o.signal=p.signal;const u=e.fetch(r,o);if(E=setTimeout((()=>{p.abort(c)}),t),p.signal.onabort=()=>{clearTimeout(E)},d=await u,clearTimeout(E),!d.ok)throw s?.error("Fetch url error response",{url:n.LU.getRedactedUrl(r),responseStatus:d.status,requestId:d.headers.get("x-request-id")}),new i(d)}catch(r){if(p.signal.aborted){const r=new Error(p.signal.reason);throw r.name="AbortError",r}throw r}finally{E&&clearTimeout(E),void 0!==a&&a.removeEventListener("abort",l)}return d}function d(r,e,t,o,a,n){const i=a||r.message,c=n||r.name,E=new s.R(c,i,{previousError:r,logMetadata:{url:e,fetchRequestOptions:t}});throw a!==u&&o&&o.error(a,E),E}async function p(r){const{host:e,logger:t,url:s,fetchRequestOptions:u}=r,p=function(r){return{shouldRetry:r=>{if(r instanceof i){const e=o.o.fromResponse(r.response);return n.LU.defaultShouldRetryHook(e)}return!0},affectDelayHook:r=>{if(r instanceof i){const e=o.o.fromResponse(r.response);return n.LU.defaultDelayHook(e)}},progressCallback:(e,t,o)=>{o?r?.error(e,t,o):r?.info(e,t)},maxAttempts:3}}(t);if(void 0!==r.abortSignal){const e=p.shouldRetry;p.shouldRetry=t=>!r.abortSignal?.aborted&&e(t)}const l=Object.assign({},p,r.retryOptionsToOverride);let f=3e4;r.timeout&&r.timeout>0&&(f=r.timeout);try{return await(0,a.XD)(E,l)(s,e,f,u,t,r.abortSignal)}catch(e){if(e instanceof Error&&"AbortError"===e.name){const r=e.message;let o=e.name;r===c&&(o="FetchRequestTimeoutError"),d(e,s,u,t,r,o)}else if(e instanceof i){if(r.returnFinalResponse)return e.response;await async function(r,e,t){if(!r.ok){let s;try{s=await r.json()}catch{}throw o.o.fromResponse(r,t,void 0,{category:e,logMetadata:{responseBody:s}})}return r}(e.response,r.finalErrorCategory,r.finalErrorCode)}else e instanceof TypeError&&d(e,s,u,t);throw e}}}}]);
//# sourceMappingURL=4409.2288d0848e7b3f6a6a4d.js.map